<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>Main</title><script type="text/javascript" src="elm-runtime.js"></script><script type="text/javascript">Elm.Main = Elm.Main || {};
Elm.Main.make = function (_elm) {
   _elm.Main = _elm.Main || {};
   if (_elm.Main.values)
   return _elm.Main.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _E = _N.Error.make(_elm),
   _J = _N.JavaScript.make(_elm),
   $moduleName = "Main";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Mouse = Elm.Mouse.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Prelude = Elm.Prelude.make(_elm);
   var Random = Elm.Random.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var Window = Elm.Window.make(_elm);
   var _op = {};
   var stepPlayer = F2(function (_v0,
   p) {
      return function () {
         switch (_v0.ctor)
         {case "_Tuple2":
            return _U.replace([["pos"
                               ,{ctor: "_Tuple2"
                                ,_0: Basics.toFloat(_v0._0)
                                ,_1: Basics.toFloat(_v0._1)}]],
              p);}
         _E.Case($moduleName,
         "on line 136, column 26 to 57");
      }();
   });
   var Click = {ctor: "Click"};
   var click = function (event) {
      return function () {
         switch (event.ctor)
         {case "Click": return true;}
         return false;
      }();
   };
   var Add = function (a) {
      return {ctor: "Add",_0: a};
   };
   var Tick = function (a) {
      return {ctor: "Tick",_0: a};
   };
   var Game = F4(function (a,
   b,
   c,
   d) {
      return {_: {}
             ,pills: b
             ,player: a
             ,score: c
             ,state: d};
   });
   var Start = {ctor: "Start"};
   var Over = {ctor: "Over"};
   var Play = {ctor: "Play"};
   var Pill = F4(function (a,
   b,
   c,
   d) {
      return {_: {}
             ,col: d
             ,pos: a
             ,rad: c
             ,vel: b};
   });
   var randFloat = function (sig) {
      return A2(Signal.lift,
      function (x) {
         return x / 100;
      },
      A2(Signal.lift,
      Basics.toFloat,
      A3(Random.range,0,100,sig)));
   };
   var rand = F2(function (fn,
   sig) {
      return A2(Signal.lift,
      fn,
      randFloat(sig));
   });
   var delta = Time.fps(30);
   var vecMulS = F2(function (_v5,
   t) {
      return function () {
         switch (_v5.ctor)
         {case "_Tuple2":
            return {ctor: "_Tuple2"
                   ,_0: _v5._0 * t
                   ,_1: _v5._1 * t};}
         _E.Case($moduleName,
         "on line 40, column 21 to 29");
      }();
   });
   var vecLen = function (_v9) {
      return function () {
         switch (_v9.ctor)
         {case "_Tuple2":
            return Basics.sqrt(_v9._0 * _v9._0 + _v9._1 * _v9._1);}
         _E.Case($moduleName,
         "on line 37, column 16 to 35");
      }();
   };
   var vecSub = F2(function (_v13,
   _v14) {
      return function () {
         switch (_v14.ctor)
         {case "_Tuple2":
            return function () {
                 switch (_v13.ctor)
                 {case "_Tuple2":
                    return {ctor: "_Tuple2"
                           ,_0: _v13._0 - _v14._0
                           ,_1: _v13._1 - _v14._1};}
                 _E.Case($moduleName,
                 "on line 34, column 27 to 39");
              }();}
         _E.Case($moduleName,
         "on line 34, column 27 to 39");
      }();
   });
   var vecAdd = F2(function (_v21,
   _v22) {
      return function () {
         switch (_v22.ctor)
         {case "_Tuple2":
            return function () {
                 switch (_v21.ctor)
                 {case "_Tuple2":
                    return {ctor: "_Tuple2"
                           ,_0: _v21._0 + _v22._0
                           ,_1: _v21._1 + _v22._1};}
                 _E.Case($moduleName,
                 "on line 31, column 27 to 39");
              }();}
         _E.Case($moduleName,
         "on line 31, column 27 to 39");
      }();
   });
   var stepPill = F2(function (t,
   p) {
      return _U.replace([["pos"
                         ,A2(vecAdd,
                         p.pos,
                         A2(vecMulS,p.vel,t))]],
      p);
   });
   var tf = F3(function (y,
   scl,
   str) {
      return Graphics.Collage.move({ctor: "_Tuple2"
                                   ,_0: 0
                                   ,_1: y})(Graphics.Collage.scale(scl)(Graphics.Collage.toForm(Text.text(Text.color(Color.gray)(Text.toText(str))))));
   });
   var center = function (_v29) {
      return function () {
         switch (_v29.ctor)
         {case "_Tuple2":
            return {ctor: "_Tuple2"
                   ,_0: A2(Basics.div,_v29._0,2)
                   ,_1: A2(Basics.div,_v29._1,2)};}
         _E.Case($moduleName,
         "on line 19, column 18 to 34");
      }();
   };
   var relativeMouse = F2(function (_v33,
   _v34) {
      return function () {
         switch (_v34.ctor)
         {case "_Tuple2":
            return function () {
                 switch (_v33.ctor)
                 {case "_Tuple2":
                    return {ctor: "_Tuple2"
                           ,_0: _v34._0 - _v33._0
                           ,_1: 0 - (_v34._1 - _v33._1)};}
                 _E.Case($moduleName,
                 "on line 16, column 33 to 50");
              }();}
         _E.Case($moduleName,
         "on line 16, column 33 to 50");
      }();
   });
   var input = A2(Signal._op["~"],
   A2(Signal._op["<~"],
   F2(function (v0,v1) {
      return {ctor: "_Tuple2"
             ,_0: v0
             ,_1: v1};
   }),
   A2(Signal.lift,
   Time.inSeconds,
   delta)),
   A2(Signal.sampleOn,
   delta,
   A3(Signal.lift2,
   relativeMouse,
   A2(Signal.lift,
   center,
   Window.dimensions),
   Mouse.position)));
   var $ = {ctor: "_Tuple2"
           ,_0: 400
           ,_1: 400},
   width = $._0,
   height = $._1;
   var $ = {ctor: "_Tuple2"
           ,_0: width / 2
           ,_1: height / 2},
   hWidth = $._0,
   hHeight = $._1;
   var randX = rand(function (r) {
      return width * r + (0 - hWidth);
   });
   var render = F2(function (_v41,
   g) {
      return function () {
         switch (_v41.ctor)
         {case "_Tuple2":
            return function () {
                 var txts = function () {
                    var _v45 = g.state;
                    switch (_v45.ctor)
                    {case "Over":
                       return _J.toList([A3(tf,
                                        70,
                                        4,
                                        "Game Over")
                                        ,A3(tf,
                                        0,
                                        4,
                                        Prelude.show(g.score))
                                        ,A3(tf,
                                        -50,
                                        2,
                                        "Click to Restart")]);
                       case "Play":
                       return _J.toList([A3(tf,
                         0,
                         4,
                         Prelude.show(g.score))]);
                       case "Start":
                       return _J.toList([A3(tf,
                                        70,
                                        4,
                                        "BluePiLL")
                                        ,A3(tf,0,2,"Click to Start")]);}
                    _E.Case($moduleName,
                    "between lines 147 and 154");
                 }();
                 var formPill = function (_v46) {
                    return function () {
                       return Graphics.Collage.move(_v46.pos)(Graphics.Collage.filled(_v46.col)(Graphics.Collage.circle(_v46.rad)));
                    }();
                 };
                 var forms = _L.append(txts,
                 List.map(formPill)({ctor: "::"
                                    ,_0: g.player
                                    ,_1: g.pills}));
                 return Graphics.Element.color(Color.lightGray)(A3(Graphics.Element.container,
                 _v41._0,
                 _v41._1,
                 Graphics.Element.middle)(Graphics.Element.color(Color.white)(A3(Graphics.Collage.collage,
                 width,
                 height,
                 forms))));
              }();}
         _E.Case($moduleName,
         "between lines 144 and 157");
      }();
   });
   var sizePill = 15;
   var sizePlayer = sizePill;
   var speed = 500;
   var spawnInterval = 57 / speed;
   var interval = Time.every(Time.second * spawnInterval);
   var defaultPill = {_: {}
                     ,col: Color.lightRed
                     ,pos: {ctor: "_Tuple2"
                           ,_0: 0
                           ,_1: hHeight}
                     ,rad: sizePill
                     ,vel: {ctor: "_Tuple2"
                           ,_0: 0
                           ,_1: 0 - speed}};
   var randCol = rand(function (r) {
      return _U.cmp(r,
      0.1) < 0 ? Color.lightBlue : defaultPill.col;
   });
   var defaultPlayer = _U.replace([["col"
                                   ,Color.black]
                                  ,["pos"
                                   ,{ctor: "_Tuple2"
                                    ,_0: 0
                                    ,_1: 0 - hHeight - sizePlayer}]],
   defaultPill);
   var defaultGame = {_: {}
                     ,pills: _J.toList([])
                     ,player: defaultPlayer
                     ,score: 0
                     ,state: Start};
   var stepPlay = F2(function (event,
   g) {
      return function () {
         switch (event.ctor)
         {case "Add":
            return _U.replace([["pills"
                               ,{ctor: "::"
                                ,_0: event._0
                                ,_1: g.pills}]],
              g);
            case "Click": return g;
            case "Tick":
            switch (event._0.ctor)
              {case "_Tuple2":
                 return function () {
                      var out = function () {
                         var $ = event._0._1,
                         x = $._0,
                         y = $._1;
                         return _U.cmp(Basics.abs(Basics.toFloat(x)),
                         hWidth) > 0 || _U.cmp(Basics.abs(Basics.toFloat(y)),
                         hHeight) > 0;
                      }();
                      var offscreen = function (_v53) {
                         return function () {
                            return _U.cmp(Basics.snd(_v53.pos),
                            0 - hHeight) > 0;
                         }();
                      };
                      var unculled = A2(List.filter,
                      offscreen,
                      g.pills);
                      var hit = function (pill) {
                         return _U.cmp(vecLen(A2(vecSub,
                         g.player.pos,
                         pill.pos)),
                         g.player.rad + pill.rad) < 0;
                      };
                      var untouched = A2(List.filter,
                      function ($) {
                         return Basics.not(hit($));
                      },
                      unculled);
                      var touched = A2(List.filter,
                      hit,
                      unculled);
                      var hitColor = function (c) {
                         return Basics.not(List.isEmpty(A2(List.filter,
                         function (_v55) {
                            return function () {
                               return _U.eq(_v55.col,c);
                            }();
                         },
                         touched)));
                      };
                      var hitBlue = hitColor(Color.lightBlue);
                      var g$ = _U.replace([["player"
                                           ,A2(stepPlayer,
                                           event._0._1,
                                           g.player)]
                                          ,["pills"
                                           ,A2(List.map,
                                           stepPill(event._0._0),
                                           untouched)]
                                          ,["score"
                                           ,hitBlue ? g.score + 1 : g.score]],
                      g);
                      var hitRed = hitColor(Color.lightRed);
                      return hitRed || out ? _U.replace([["score"
                                                         ,g$.score]
                                                        ,["state",Over]],
                      defaultGame) : g$;
                   }();}
              break;}
         _E.Case($moduleName,
         "between lines 97 and 119");
      }();
   });
   var stepGame = F2(function (event,
   _v57) {
      return function () {
         return function () {
            var playGame = _U.replace([["state"
                                       ,Play]],
            defaultGame);
            var toPlay = click(event) ? playGame : _v57;
            return function () {
               var _v59 = _v57.state;
               switch (_v59.ctor)
               {case "Play":
                  return A2(stepPlay,event,_v57);}
               return toPlay;
            }();
         }();
      }();
   });
   var newPill = F2(function (x,
   col) {
      return _U.replace([["pos"
                         ,{ctor: "_Tuple2"
                          ,_0: x
                          ,_1: hHeight}]
                        ,["col",col]],
      defaultPill);
   });
   var event = Signal.merges(_J.toList([A2(Signal.lift,
                                       Tick,
                                       input)
                                       ,A3(Signal.lift2,
                                       F2(function (x,col) {
                                          return Add(A2(newPill,
                                          x,
                                          col));
                                       }),
                                       randX(interval),
                                       randCol(interval))
                                       ,A2(Signal.lift,
                                       function (_v60) {
                                          return function () {
                                             return Click;
                                          }();
                                       },
                                       Mouse.isClicked)]));
   var main = A2(Signal._op["~"],
   A2(Signal._op["<~"],
   render,
   Window.dimensions),
   A3(Signal.foldp,
   stepGame,
   defaultGame,
   event));
   _elm.Main.values = {_op: _op
                      ,speed: speed
                      ,sizePill: sizePill
                      ,sizePlayer: sizePlayer
                      ,spawnInterval: spawnInterval
                      ,height: height
                      ,width: width
                      ,hHeight: hHeight
                      ,hWidth: hWidth
                      ,relativeMouse: relativeMouse
                      ,center: center
                      ,tf: tf
                      ,vecAdd: vecAdd
                      ,vecSub: vecSub
                      ,vecLen: vecLen
                      ,vecMulS: vecMulS
                      ,delta: delta
                      ,input: input
                      ,randFloat: randFloat
                      ,rand: rand
                      ,randX: randX
                      ,randCol: randCol
                      ,interval: interval
                      ,event: event
                      ,defaultPill: defaultPill
                      ,defaultPlayer: defaultPlayer
                      ,defaultGame: defaultGame
                      ,newPill: newPill
                      ,stepPlay: stepPlay
                      ,click: click
                      ,stepGame: stepGame
                      ,stepPlayer: stepPlayer
                      ,stepPill: stepPill
                      ,render: render
                      ,main: main
                      ,Play: Play
                      ,Over: Over
                      ,Start: Start
                      ,Tick: Tick
                      ,Add: Add
                      ,Click: Click
                      ,Pill: Pill
                      ,Game: Game};
   return _elm.Main.values;
};</script></head><body><script type="text/javascript">Elm.fullscreen(Elm.Main)</script><noscript></noscript></body></html>
